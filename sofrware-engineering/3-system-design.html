<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/js/highlight.pack.js" type="text/javascript"></script>
<script src="/js/include_html.js" type="text/javascript"></script>
<script src="/js/mathjax.js" type="text/javascript"></script>
<script src="/js/site.js" type="text/javascript"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Other</h1>

<!-- System design BEGIN -->
<div class="card mb-4" id="system-design">
  <div class="card-body">
    <h2 class="card-title">System design</h2>
    <ul class="list-unstyled mb-0">
      <li><a href="#system-design-1">Non-functional requirements</a></li>
      <li><a href="#system-design-2">Back-of-the-envelop</a></li>
      <li><a href="#system-design-3">Resource estimation</a></li>
      <li><a href="#system-design-4">System design</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="system-design-1">
  <div class="card-body">
    <h2 class="card-title">Non-functional requirements</h2>

    <h2 class="card-title">Availability</h2>
    <ul>
      <li>Percentage of time that the service is accessible to clients.</li>
      <li>Associated with time loss.</li>
    </ul>

    <h2 class="card-title">Reliability</h2>
    <ul>
      <li>Probability that the service will perform its functions.</li>
      <li>Associated with frequency and impact of failure.</li>
      <li>Metrics are mean time between failures and mean time to repair.</li>
    </ul>

    <h2 class="card-title">Scalability</h2>
    <ul>
      <li>Ability to handle increasing workload without degrading performance.</li>
      <li>Workload can be number of requests or amounts of data.</li>
    </ul>

    <h2 class="card-title">Maintainability</h2>
    <ul>
      <li>Probability that the service will restore its function. (When broken)</li>
      <li>Workload can be number of requests or amounts of data.</li>
      <li>Metrics are mean time to repair.</li>
    </ul>

    <h2 class="card-title">Fault tolerance</h2>
    <ul>
      <li>Ability to continue to perform when some components fail.</li>
    </ul>
  </div>
  <div class="card-footer text-muted">

  </div>
</div>

<div class="card mb-4" id="system-design-2">
  <div class="card-body">
    <h2 class="card-title">Back-of-the-envelop</h2>

    <h3 class="card-title">Web servers</h3>
    <ul>
      <li>Typically serve static content to client. (Web browser)</li>
      <li>Usually handle API calls from clients.</li>
    </ul>

    <h3 class="card-title">App servers</h3>
    <ul>
      <li>Typically serve dynamic content to client.</li>
      <li>Core business logic.</li>
    </ul>

    <h3 class="card-title">Important latencies</h3>
    <table>
      <tr>
        <td>L1 cache reference</td>
        <td>0.9</td>
      </tr>
      <tr>
        <td>L2 cache reference</td>
        <td>2.8</td>
      </tr>
      <tr>
        <td>L3 cache reference</td>
        <td>12.9</td>
      </tr>
      <tr>
        <td>Main memory reference</td>
        <td>100</td>
      </tr>
      <tr>
        <td>Compress 1KB with Snzip</td>
        <td>3,000 (3 microseconds)</td>
      </tr>
      <tr>
        <td>Read 1 MB sequentially from memory</td>
        <td>9,000 (9 microseconds)</td>
      </tr>
      <tr>
        <td>Read 1 MB sequentially from SSD</td>
        <td>200,000 (200 microseconds)</td>
      </tr>
      <tr>
        <td>Round trip within same datacenter</td>
        <td>500,000 (500 microseconds)</td>
      </tr>
      <tr>
        <td>Read 1 MB sequentially from SSD with speed ~1GB/sec SSD</td>
        <td>1,000,000 (1 milliseconds)</td>
      </tr>
      <tr>
        <td>Disk seek</td>
        <td>4,000,000 (4 milliseconds)</td>
      </tr>
      <tr>
        <td>Read 1 MB sequentially from disk</td>
        <td>2,000,000 (2 milliseconds)</td>
      </tr>
      <tr>
        <td>Send packet SF->NYC</td>
        <td>71,000,000 (71 milliseconds)</td>
      </tr>
    </table>

    <h3 class="card-title">Important rates</h3>
    <table>
      <tr>
        <td>QPS handled by MySQL</td>
        <td>1000</td>
      </tr>
      <tr>
        <td>QPS handled by key-value store</td>
        <td>10,000</td>
      </tr>
      <tr>
        <td>QPS handled by cache server</td>
        <td>100,000â€“1 M</td>
      </tr>
    </table>
  </div>
  <div class="card-footer text-muted">
    Reference: <a href="https://www.educative.io/path/deep-dive-into-system-design-interview">Deep Dive into System Design Interview</a>
  </div>
</div>

<div class="card mb-4" id="system-design-3">
  <div class="card-body">
    <h2 class="card-title">Resource estimation</h2>

    <h3 class="card-title">Request per second</h3>
    <ul>
      <li>Assume</li>
      <ul>
        <li>Server has 36 cores (72 threads), 256 GB RAM</li>
        <li>OS and other processes consumed 16 GB RAM.</li>
        <li>Each worker consumes 300 MB RAM to complte a request.</li>
        <li>Each CPU-bound request takes 200 millisecond.</li>
        <li>Each memory-bound request takes 50 milliseconds.</li>
      </ul>
      <li>RPS (CPU) = number of thread / time each task takes = 72 / 200 ms = 360 RPS</li>
      <li>RPS (RAM) = Available memory / (time each task takes * worker memory comsumption) = 240 GB / (50 ms * 300 MB)= 16,000 RPS</li>
      <li>Assume half requests are CPU bound and half requests are memory bound: 360 / 2 + 16,000 / 2 = 8,000 RPS</li>
    </ul>

    <h3 class="card-title">Estimate number of servers</h3>
    <ul>
      <li>Assume 500M daily users and 20 request per day on average.</li>
      <li>Then, 10B requests per day, which is 115K requests per seconds.</li>
      <li>So, looks like 15 servers (that can handle 8,000 RPS) can handle 500M users?</li>
      <li>In reality, requests may go through many differnt servers, not just a single server.</li>
      <li>First, assume each user sends one request per day. (Number of requests per day / 8,000 RPS)</li>
      <li>Then, assume all requests from all users arrive simultaneously during peak load. (Number of requests per second / 8,000 RPS)</li>
      <li>Thus, 500M / 8,000 = 62,000 servers are needed.</li>
    </ul>


    <h3 class="card-title">Estimate storage</h3>
    <ul>
      <li>Assume 250M daily active users and each user makes 3 write requests per day.</li>
      <li>Assume 10% contains images, 5% contains videos, 85% contain just text.</li>
      <li>Assume each image is 200 KB, video is 3 MB, and text is 250 bytes.</li>
      <li>Storage required: (250 * 3) * (250 B + 200 KB * 0.1 + 3 MB * 0.05) = 128 TB per day.</li>
    </ul>

    <h3 class="card-title">Estimate bandwitdth</h3>
    <ul>
      <li>Incoming traffic: (128 TB per day / 86400 seconds per day) * 8 bits per byte = 12 Gbps.</li>
      <li>Assume each user make 50 read requests per day.</li>
      <li>Outgoing traffic: (12 Gbps / 3) * 50 = 197.5 Gbps.</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: <a href="https://www.educative.io/path/deep-dive-into-system-design-interview">Deep Dive into System Design Interview</a>
  </div>
</div>

<div class="card mb-4" id="system-design-4">
  <div class="card-body">
    <h2 class="card-title">System design</h2>

    <h3 class="card-title">High level design</h3>
    <img class="img-fluid" class="card-img-top" src="/img/system-design/sd-cicd.png" alt="Card image cap">

    <h3 class="card-title">Component design</h3>

  </div>
  <div class="card-footer text-muted">

  </div>
</div>
<!-- System design END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>