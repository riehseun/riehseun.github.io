<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/js/highlight.pack.js" type="text/javascript"></script>
<script src="/js/include_html.js" type="text/javascript"></script>
<script src="/js/mathjax/tex-chtml.js" type="text/javascript"></script>
<script src="/js/site.js" type="text/javascript"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Machine learning</h1>

<!-- Machine Learning System Sesign BEGIN -->
<div class="card mb-4" id="machine-learning-system-design">
  <div class="card-body">
    <h2 class="card-title">Machine Learning System Design</h2>
    <ul>
      <li><a href="/machine-learning-system-design/a-designing-machine-learning-systems.html">Designing Machine Learning Systems</a></li>
      <li><a href="/machine-learning-system-design/d-hello-interview.html">Hello Interview</a></li>
      <li><a href="/machine-learning-system-design/eai-evidently-ai.html">Evidently AI</a></li>
    </ul>    

    <h3 class="card-title">Machine learning system design</h3>
    <ul>
      <li><a href="/machine-learning-system-design/b-introduction-and-overview.html">Introduction and Overview</a></li>
      <li><a href="/machine-learning-system-design/b-visual-search-system.html">Visual Search System</a></li>
      <li><a href="/machine-learning-system-design/b-google-street-view-blurring-system.html">Google Street View Blurring System</a></li>
      <li><a href="/machine-learning-system-design/b-youtube-video-search.html">Youtube Video Search</a></li>
      <li><a href="/machine-learning-system-design/b-harmful-content-detection.html">Harmful Content Detection</a></li>
      <li><a href="/machine-learning-system-design/b-video-recommendation-system.html">Video Recommendation System</a></li>
      <li><a href="/machine-learning-system-design/b-event-recommendation-system.html">Event Recommendation System</a></li>
      <li><a href="/machine-learning-system-design/b-ad-click-prediction-on-social-platform.html">Ad Click Prediction on Social Platforms</a></li>
      <li><a href="/machine-learning-system-design/b-similar-listings-on-vacation-rental-platforms.html">Similar Listings on Vacation Rental Platforms</a></li>
      <li><a href="/machine-learning-system-design/b-personalized-news-feed.html">Personalized Newsfeed</a></li>
      <li><a href="/machine-learning-system-design/b-people-you-may-know.html">People You May Know</a></li>
    </ul>

    <h3 class="card-title">Generative AI system design</h3>
    <ul>
      <li><a href="/machine-learning-system-design/c-introduction-and-overview.html">Introduction and Overview</a></li>
      <li><a href="/machine-learning-system-design/c-gmail-smart-compose.html">Google Smart Compose</a></li>
      <li><a href="/machine-learning-system-design/c-google-translate.html">Google Translate</a></li>
      <li><a href="/machine-learning-system-design/c-chatgpt.html">ChatGPT</a></li>
      <li><a href="/machine-learning-system-design/c-image-captioning.html">Image Captioning</a></li>
      <li><a href="/machine-learning-system-design/c-rag.html">RAG</a></li>
      <li><a href="/machine-learning-system-design/c-realistic-face-generation.html">Realistic Face Generation</a></li>
      <li><a href="/machine-learning-system-design/c-high-resolution-image-synthesis.html">High-Resolution Image Synthesis</a></li>
      <li><a href="/machine-learning-system-design/c-text-to-image-generation.html">Text-to-Image Generation</a></li>
      <li><a href="/machine-learning-system-design/c-personalized-headshot-generation.html">Personalized Headshot Generation</a></li>
      <li><a href="/machine-learning-system-design/c-text-to-video-generation.html">Text-to-Video Generation</a></li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu | Generative AI System Design Interview, Ali Aminian & Hao Sheng | <a href="https://www.hellointerview.com">hello interview</a>
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h3 class="card-title">ML problem</h3>
    <ul>
      <li>Identify input and output of model</li>
      <li>Discrimitive</li>
      <ul>
        <li>Recommendation system</li>
        <li>Fraud detection</li>
        <li>Churn prediction</li>
      </ul>
      <li>Generative</li>
      <ul>
        <li>Machine translation</li>
        <li>Sentiment analysis</li>
        <li>Text, image, video generation</li>
      </ul>
    </ul>

    <h3 class="card-title">ML category</h3>
    <ul>
      <li>Discrimitive</li>
      <ul>
        <li>Supervised learning</li>
        <ul>
          <li>Neural networks</li>
          <ul>
            <li>Linear network</li>
            <ul>
              <li>Linear regression (regression only)</li>
              <li>Logistic regression (classification only - binary, multi-class)</li>
            </ul>
            <li>Deep neural networks</li>
          </ul>
          <li>Decision trees</li>
          <li>k-nearest neighbors (KNN)</li>
        </ul>
        <li>Unsupervised learning</li>
        <ul>
          <li>Clustering</li>
          <ul>
            <li>Density-based spacial clustering with noise (DBSCAN)</li>
            <li>K-means clustering - partition points into K subsets, compute centroid of current partitioning, assign each point to cluster</li>
          </ul>
          <li>Dimension reduction</li>
          <ul>
            <li>Principle component analysis (PCA)</li>
            <li>Isomap</li>
          </ul>
        </ul>
      </ul>
      <li>Generative</li>
      <ul>
        <li>Text</li>
        <ul>
          <li>Pre-training</li>
          <ul>
            <li>Encoder-decoder</li>
            <li>Encoder only</li>
            <li>Decoder only</li>
          </ul>
          <li>Fine-tuning</li>
          <ul>
            <li>Reinforcement learning from human feedback</li>
          </ul>
          <li>Retrieval augmented generation</li>
          <ul>
            <li>Agentic</li>
          </ul>
        </ul>
        <li>Image</li>
        <ul>
          <li>Variational autoencoders (VAEs)</li>
          <li>Generative adversarial networks (GANs)</li>
          <li>Diffusion models</li>
          <li>Autoregressive models</li>
        </ul>
      </ul>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu | Generative AI System Design Interview, Ali Aminian & Hao Sheng
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">High-level design</h2>

    <h3 class="card-title">Pipeline</h3>
    <ul>
      <li>Data</li>
      <img class="img-fluid" class="card-img-top" src="/machine-learning-system-design/image/mlsd-0/machine-learning-system-design-1.png" alt="Card image cap">
      <li>Training</li>
      <img class="img-fluid" class="card-img-top" src="/machine-learning-system-design/image/mlsd-0/machine-learning-system-design-2.png" alt="Card image cap">
      <li>Serving</li>
      <img class="img-fluid" class="card-img-top" src="/machine-learning-system-design/image/mlsd-0/machine-learning-system-design-3.png" alt="Card image cap">
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu | Generative AI System Design Interview, Ali Aminian & Hao Sheng
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Data and feature engineering</h2>

    <h3 class="card-title">Data engineering</h3>
    

    <h3 class="card-title">Feature engineering</h3>
    <li>Feature selection</li>
    <ul>
      <li>Prioritize most expressive features explaining why they are predictive</li>
      <li>Ex. Leverage domain experts to select universe of features</li>
      <li>Ex. Use decision tree to narrow down features</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu | Generative AI System Design Interview, Ali Aminian & Hao Sheng
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Model development</h2>
    <ul>
      <li>Start with benchmark model</li>
    </ul>

    <h3 class="card-title">Model selection</h3>
    <ul>
      <li>Linear or logistic regression</li>
      <ul>
        <li>Pros</li>
        <ul>
          <li>Simple to implement</li>
          <li>Explainable</li>
        </ul>
        <li>Cons</li>
        <ul>
          <li>Low accuracy</li>
        </ul>
      </ul>
      <li>Decision trees or XGBoost</li>
      <ul>
        <li>Pros</li>
        <ul>
          <li>No need to handle missing values</li>
          <li>No need to scale features</li>
          <li>Explainable</li>
        </ul>
        <li>Cons</li>
        <ul>
          <li>New data or features require entire model to be retrained</li>
        </ul>
      </ul>
      <li>Neural network</li>
      <ul>
        <li>Pros</li>
        <ul>
          <li>Handles unstructured data</li>
          <li>Can produce embeddings</li>
        </ul>
        <li>Cons</li>
        <ul>
          <li>Lots of dataprep</li>
          <li>Lots of hyperparameter tuning</li>
          <li>Not explainable</li>
        </ul>
      </ul>
    </ul>

    <h3 class="card-title">Model training</h3>
    <ul>
      <li>Data split</li>
      <li>Class imbalance</li>
      <li>Loss function</li>
      <ul>
        <li>Regression</li>
        <ul>
          <li>MSE</li>
          <li>MAE</li>
        </ul>
        <li>Binary classification</li>
        <ul>
          <li>Log loss</li>
        </ul>
        <li>Multiclass classification</li>
        <ul>
          <li>Cross-entropy</li>
        </ul>
        <li>?</li>
        <ul>
          <li>Huber loss</li>
        </ul>
      </ul>
      <li>Hyperparameters</li>
      <ul>
        <li>XGBoost</li>
        <ul>
          <li></li>
        </ul>
        <li>Neural network</li>
        <ul>
          <li>Learning rate</li>
          <li>Number of hidden layers</li>
          <li>Batch size</li>
          <li>Number of epochs</li>
          <li>Dropout rate</li>
        </ul>
      </ul>
      <li>Sampling</li>
      <ul>
        <li>Model recalibration</li>
        <ul>
          <li>Assume undersampling</li>
          <li>\( q = \dfrac{p}{p+\dfrac{1-p}{w}} \)</li>
          <ul>
            <li>\( q \) - re-calibrated prediction score</li>
            <li>\( p \) is prediction in downsampling space</li>
            <li>\( w \) is undersampling rate</li>
          </ul>
        </ul>
      </ul>
      <!-- <li>Regularization</li>
      <ul>
        <li>L1</li>
        <li>L2</li>
        <li>Entropy regularization</li>
        <li>K-fold CV</li>
        <li>Dropout</li>
      </ul>
      <li>Optimization</li>
      <ul>
        <li>SGD</li>
        <li>AdaGrad</li>
        <li>Momentum</li>
        <li>RMSProp</li>
      </ul>
      <li>Activation</li>
      <ul>
        <li>ELU</li>
        <li>ReLU</li>
        <li>Tanh</li>
        <li>Sigmoid</li>
      </ul>
      <li>Save the transformation applied to convert model inputs into features</li>
      <li>How to overcome underfitting and overfitting (bias and variance)</li> -->
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu | Generative AI System Design Interview, Ali Aminian & Hao Sheng
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Inference and dvaluation</h2>

    <h3 class="card-title">Offline</h3>
    <ul>
      <li>Classification</li>
      <ul>
        <li>Precision</li>
        <li>Recall</li>
        <li>F1 score</li>
        <li>Accuracy</li>
        <li>ROC-AUC</li>
        <ul>
          <li>Used for binary classification</li>
          <li>Does not penalize how far off predicted score is from the actual label</li>
          <li>Insensitive to well-calibrated probabilities</li>
        </ul>
        <li>PR-AUC</li>
        <li>Confusion matrix</li>
      </ul>
      <li>Regression</li>
      <ul>
        <li>MSE</li>
        <li>MAE</li>
        <li>RMSE</li>
      </ul>
      <li>Ranking</li>
      <ul>
        <li>Precision@k</li>
        <li>Recall@k</li>
        <li>MRR</li>
        <li>mAP</li>
        <ul>
          <li>Assume total items are 10. Recommended items are 5 and user find 3 of them relevant</li>
          <li>\( AP@N = \frac{1}{m} \sum_{k=1}^N P(k) \cdot rel(k) = \frac{1}{10} \cdot (1*\frac{1}{1} + 1*\frac{2}{2} + 0*\frac{2}{3} + 1*\frac{3}{4} + 0*\frac{3}{5}) = 0.275 \)</li>
        </ul>
        <li>mAR</li>
        <ul>
          <li>\( AR@N = \frac{1}{m} \sum_{k=1}^N R(k) \cdot rel(k) = \frac{1}{10} \cdot (1*\frac{1}{10} + 1*\frac{2}{10} + 0*\frac{2}{10} + 1*\frac{3}{10} + 0*\frac{3}{10}) = 0.06 \)</li>
        </ul>
        <li>nDCG</li>
        <ul>
          <li>Assume the documents are \( D1, D2, D3, D4 \) in the order of relevance</li>
          <li>Assume human rates the documents on scale of 0-3 (3 is highly relevant, 0 is merely relevant) such that</li>
          <ul>
            <li>\( D1=3, D2=2, D3=3, D4=0 \)</li>
          </ul>
          <li>Cumulative gain simply adds</li>
          <ul>
            <li>\( 3 + 2 + 3 + 0 = 8 \)</li>
          </ul>
          <li>Discounted cumulative gain (DCG) penalizes if highly relevant document appears lower in the result</li>
          <ul>
            <li>\( \frac{3}{log(1+1)} + \frac{2}{log(2+1)} + \frac{3}{log(3+1)} + \frac{0}{log(4+1)} = 3 + 1.262 + 1.5 + 0 = 5.762 \)</li>
          </ul>
          <li>Discounted cumulative gain for a query with long result will be higher due to its length rather than its quality</li>
          <li>Normalized discounted cumulative gain (NDCG) is computed by (DCG / IDCG) where IDCG is DCG of ideal ordering</li>
          <ul>
            <li>Near 1 means good result. Near 0 means bad result</li>
            <li>Caveat - NDCG does not penalize irrelevant search result</li>
          </ul>
        </ul>
      </ul>
      <li>Text generation</li>
      <ul>
        <li>BLUE</li>
        <li>METEOR</li>
        <li>ROUGE</li>
        <li>CIDEr</li>
        <li>SPICE</li>
      </ul>
      <li>Image generation</li>
      <ul>
        <li>FID</li>
        <li>Inception score</li>
      </ul>
    </ul>
      <!-- <li>Baselines</li>
      <ul>
        <li>Random baseline</li>
        <li>Simple heuristic</li>
        <li>Zero rule baseline</li>
        <li>Human baseline</li>
        <li>Existing solutions</li>
      </ul>
      <li>Methods</li>
      <ul>
        <li>Purturbation tests</li>
        <li>Invariance tests</li>
        <li>Directional expectation tests</li>
        <li>Model calibration</li>
        <li>Confidence measurement</li>
        <li>Slice-based evaluation</li>
      </ul> -->
    
    <h3 class="card-title">Online</h3>
    <ul>
      <li>Increase in revenue</li>
      <li>Increase in engagement - number of users, click through rate, dwell time, etc</li>
      <li>Decrease in counter metrics - number of hides, blocks, etc</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu | Generative AI System Design Interview, Ali Aminian & Hao Sheng
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Detailed design</h2>

    <!-- <li>Pre-processing</li>
    <ul>
      <li>Query rewriting</li>
      <ul>
        <li>Spell checker - fix basic spelling mistakes</li>
        <li>Query expansion - add terms to user query. For example, "restaurant" is expaneded to "food" or "recipe"</li>
      </ul>
    </ul> -->
    
    <!-- <ul>
      <li>ML failure</li>
      <ul>
        <li>Edge cases</li>
        <li>Degenerate feedback loops</li>
        <ul>
          <li>Detecting</li>
          <li>Correcting</li>
        </ul>
      </ul>
    </ul> -->

    <!-- <li>Two-phase prediction</li>
    <ul>
      <li>A problem is split into two parts</li>
      <li>Smaller and cheaper model deployed on device that can achieve high accuracy</li>
      <li>More complex model on cloud that is triggered only when it is needed</li>
    </ul> -->
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu | Generative AI System Design Interview, Ali Aminian & Hao Sheng
  </div>
</div>
<!-- Machine Learning System Design END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>