<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/js/highlight.pack.js" type="text/javascript"></script>
<script src="/js/include_html.js" type="text/javascript"></script>
<script src="/js/mathjax/tex-chtml.js" type="text/javascript"></script>
<script src="/js/site.js" type="text/javascript"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Machine Learning</h1>

<!-- Fraud detection BEGIN -->
<div class="card mb-4" id="fraud-detection">
  <div class="card-body">
    <h2 class="card-title">Fraud detection</h2>
    <ul class="list-unstyled mb-0">
      <li><a href="#fraud-detection-">Fraud detection</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="fraud-detection-">
  <div class="card-body">
    
<pre><code class="markdown">
Requirement and problem

Business
  What kind of fraud are we talking about? Fradulent financial transaction - #1
Data
  How does dataset look like? Structured - #2
  Do we have labeled dataset? Yes
Constraint
  Should we continously train the model? No
  Should model be deployed to mobile devices? No
  How fast should inference be? Under 200ms
  Should inference be batch or real-time? Real-time - #3
Problem - given transaction, determine whether it is fradulent or not
Input - transaction record
Output - 0 or 1 indicating fraud or not

High-level design

Data and feature engineering

Data
  Customer
  Account
  Transaction
Feature
  Age/gender/ethnicity - can't use due to bias and fairness concern
  Account balance - fraud people are not likely to have very high account balance
  Duration of account - fraud people are likely to have newly created account
  Number of transactions - fraud people are likely to have only recent transactions
  Total amount of transactions - fraud people are likely to have little dollar amount of transactions
Engineering
  No need to scale or nomalize if using Ensemble model
  Ensemble models are expensive to re-train, thus need extra feature engineering to guard against distribution drift
  Compute "averge metrics" like averge account balance for the past 12 months, as these values are less impacted by distribution drift
  Create "other" columns for data points that are outside 99% of values and put it in
  Convert date field to integer

Model development

Baseline
  Logistic regression - binary classification to determine whether transaction is fraud or not
  If dataprep is too much overhead, may skip to Ensemble model directly
Model
  Ensemble - explanable, works well with structured data, no need for data engineering, no need to worry about missing values
  Neural network - lots of dataprep, not explanable
Data split
  Split labeled data by time - 80% training set, 20% test set
  Further split 80% training set into - 70% training set, 30% dev set
  Run 5 bins cross-validation
  Make sure each customer Id exist in exactly one of the bins and validation set, to avoid data leakage

Inference and evaluation

Sampling
  N/A
Offline metric
  Recall - need to get actual fraud as much as possible
  Precision - predicted fraud better be actual fraud
  PR curve
Online metric
  Number of fraud found in transactions
</code></pre>

    <img class="img-fluid" class="card-img-top" src="/machine-learning-system-design/image/mlsd-1/fraud-detection-1.png" alt="Card image cap">

  </div>
  <div class="card-footer text-muted">
    Reference: 
  </div>
</div>
<!-- Fraud detection END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>