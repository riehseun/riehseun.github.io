<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/js/highlight.pack.js" type="text/javascript"></script>
<script src="/js/include_html.js" type="text/javascript"></script>
<script src="/js/mathjax/tex-chtml.js" type="text/javascript"></script>
<script src="/js/site.js" type="text/javascript"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Machine Learning</h1>

<!-- Fraud Detection BEGIN -->
<div class="card mb-4" id="fraud-detection">
  <div class="card-body">
    <h2 class="card-title">Fraud Detection</h2>
    <ul class="list-unstyled mb-0">
      <li><a href="#fraud-detection-">Fraud Detection</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="fraud-detection-">
  <div class="card-body">

    <h2 class="card-title">Fraud Detection</h2>

    <img class="img-fluid" class="card-img-top" src="/machine-learning-system-design/image/mlsd-1/4-1-1.png" alt="Card image cap">
    
<pre><code class="markdown">
# Requirement and Problem

What kind of fraud is this? Fraudulent financial transactions 
How does fraud occur? Use stolen debit or credit card to make purchases
Where does fraud occur? In website or app, purchases are made
Should model explain why transaction is deemed fraud? Yes

Do we have training data available? Yes, 1M fraud transactions and 100M non-fraud transactions
Should inference be immediate? Yes
Should model be continuously trained? Yes
Should model be deployed to mobile devices? No

Input - person and transaction
Output - whether transaction is fraud or not
Problem - binary classification

# High-Level Design

# Data and Feature Engineering

## Data model
User, Account, Transaction

## Feature
User’s age, account’s age, account balance
Transaction $ amount
Debit/Credit card’s limit, transaction limit, age, 
Number of transactions in past X hours
Average number of transactions per month

## Feature engineering 
Numerical
Categorical dense (age - bucketize) - one-hot
No need to scale or nomalize if using Ensemble model
Compute "averge metrics" like averge account balance for the past 12 months, as these values are less impacted by distribution drift
Create "other" columns for data points that are outside 99% of values and put it in
Convert date field to integer
  
# Model Development

## Baseline
Logistic regression 

## Architecture
NN models are not explainable
Use XGBoost - no standardization needed but is expensive to re-train

## Training
Data split
Split labeled data by time - 80% training set, 20% test set
Further split 80% training set into - 70% training set, 30% dev set
Run 5 bins cross-validation
Make sure each customer Id exist in exactly one of the bins and validation set, to avoid data leakage

# Inference and Evaluation

## Offline
Recall - catching actual fraud is very important
Precision - accuracy of prediction is important not to reject valid transaction to annoy users

## Online
Decrease in average number of fraud per month
</code></pre>
  </div>
  <div class="card-footer text-muted">
    Reference: 
  </div>
</div>
<!-- Fraud Detection END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>