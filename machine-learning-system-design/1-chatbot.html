<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/js/highlight.pack.js" type="text/javascript"></script>
<script src="/js/include_html.js" type="text/javascript"></script>
<script src="/js/mathjax/tex-chtml.js" type="text/javascript"></script>
<script src="/js/site.js" type="text/javascript"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Machine Learning</h1>

<!-- Chatbot BEGIN -->
<div class="card mb-4" id="chatbot">
  <div class="card-body">
    <h2 class="card-title">Chatbot</h2>
    <ul class="list-unstyled mb-0">
      <li><a href="#chatbot-">Chatbot</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="chatbot-">
  <div class="card-body">
    <h2 class="card-title">Chatbot</h2>

<pre><code class="markdown">
Requirement and problem

Business
  What is purpose of chatbot?
  Should chatbot have general knowledge or also domain specific knowledge? Domain specific - #1
  Should chatbot support text, image, video, math, etc? Text only - #2
  Should chatbot consider human-preferable answers? yes - #3 (if time)
Data
  Do we have training data? We have corpus that we can crawl from web
  Do we also have domain specific data? Yes, 100M sets of questions and answers
Contraint
  Should model be deployed to mobile devices? No
  How fast should inference be - under 200ms
Problem - generate response per user query
Input - user prompt
Output - text response from model

Data and feature engineering

Data
  Tokenization
  Token to IDs
Feature

Model development

Pre-training
  Training with large corpus to learn general pattern
  Transformer based decoder model
  Loss - cross-entropy to predict likelihood of next token
Fine-tuning
  With pre-trained model, fine-tune with domain specific data
  Transformer based decoder model
  Loss - cross-entropy to predict likelihood of next token
Reinforcement learning from human feedback
  Training data - for same user input, rank model outputs
RAG
  Ingest domain specific data into vector database
  Find cosine similarity between user query embedding and document embeddings in vector DB to retrieve top k results
  Use separate re-ranker to find most relevant document
  Call model with user query and document
  No model training but slower due to having to query vector DB and re-ranker

Inference and evaluation

Sampling
  Top k sampling - deterministic because it only considers k most probable words (Ex. beam search)
  Top p sampling - provides little randomness by including all words up to certain probability (p)

Evaluation
  RAG
    Retriever - recall 
    Reranker - precision
    Model - factual accuracy, number of harmful response
</code></pre>

    <img class="img-fluid" class="card-img-top" src="/machine-learning-system-design/image/mlsd1/chatbot-1.png" alt="Card image cap">

    <img class="img-fluid" class="card-img-top" src="/machine-learning-system-design/image/mlsd1/chatbot-2.png" alt="Card image cap">

  </div>
  <div class="card-footer text-muted">
    Reference:
  </div>
</div>
<!-- Chatbot END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>