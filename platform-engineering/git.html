<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>
<script src="/js/highlight.pack.js"></script>
<script type="text/javascript" src="/js/include_html.js"></script>
<script type="text/javascript" src="/js/site.js"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Platform Engineering</h1>

<!-- Git BEGIN -->
<div class="card mb-4" id="git">
  <div class="card-body">
    <h2 class="card-title">GIT</h2>
    <ul class="list-unstyled mb-0">
      <li><a href="#git-1">Branching strategy</a></li>
      <li><a href="#git-2">Git concets</a></li>
      <li><a href="#git-3">Git commands</a></li>
      <li><a href="#git-4">Squashing commits</a></li>
      <li><a href="#git-5">Branching</a></li>
      <li><a href="#git-6">Revert</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="git-1">
  <div class="card-body">
    <h2 class="card-title">Branching strategy</h2>
    <p class="card-text"></p>

    <h3 class="card-title">Git flow</h3>
    <p class="card-text">Useful when keep many versions of production code from the release branches.</p>
    <ul>
      <li><code>master</code> - represent the production.</li>
      <li><code>release</code> - branch to perform release. Must be merged into both develop and master branches.</li>
      <li><code>develop</code> - branch for active development. All features branches must be cut from and merged to this branch.</li>
      <li><code>feature</code> - branch for each developer working on a feature. Developers should regularly pull from develop branch to keep feature branches up to date.</li>
      <li><code>hotfix</code> - branch to quickly apply changes to master branch without going through the full flow. Must be merged into both master and develop branch.</li>
    </ul>
    <img class="img-fluid" class="card-img-top" src="/img/git/git1.png" alt="Card image cap">
    <br>
    <br>

    <h3 class="card-title">Github flow</h3>
    <p class="card-text">Simpler but aimed at maintaining a single version of production code.</p>
    <ul class="list-unstyled mb-0">
      <li>There are only <code>master</code> and <code>feature</code> branch.</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: <a href="https://www.bmc.com/blogs/devops-branching-strategies">DevOps Branching Strategies Explained</a>
  </div>
</div>

<div class="card mb-4" id="git-2">
  <div class="card-body">
    <h2 class="card-title">Git concepts</h2>

    <ul>
      <li><code>git add</code> - move files from <strong>untracked/modified</strong> state to <strong>staged</strong> state.</li>
      <li><code>git commit</code> - move files from <strong>staged</strong> state to <strong>committed</strong> state.</li>
    </ul>

    <ul>
      <li><code>git fetch</code> - gather commits from remote that don't exist in local.</li>
      <li><code>git merge</code> - integrate commits to your branch.</li>
      <li><code>git pull</code> - git fetch + git merge.</li>
    </ul>

    <ul>
      <li><code>branch</code> - a version of code.</li>
      <li><code>git cherry-pick</code> - get a commit from one branch and integrate to another branch.</li>
      <li><code>HEAD</code> - last commit of current branch.</li>
    </ul>

    <h3 class="card-title">Fork vs Clone</h3>
    <ul>
      <li><code>Fork</code> - creates server side copy of repository.</li>
      <li><code>Clone</code> - gets local copy of repository of a server including history and branches.</li>
    </ul>
  </div>
  <div class="card-footer text-muted">

  </div>
</div>

<div class="card mb-4" id="git-3">
  <div class="card-body">
    <h2 class="card-title">Git commands</h2>
    <p class="card-text"></p>

    <h3 class="card-title">Git init</h3>
<pre><code class="bash"># Make the local repository aware of the remote.
git remote add origin &lt;remote_url&gt;

# For example, to fix corrupt git repository.
rm -rf .git
git init
git remote add origin &lt;clone_url&gt;
git fetch
git reset origin/master</code></pre>

    <h3 class="card-title">Copy a repo to another repo</h3>
<pre><code class="bash">git clone --bare --quiet &lt;git_clone_url_to_copy_from&gt;
git push --mirror --quiet &lt;git_clone_url_to_copy_into&gt;</code></pre>

    <h3 class="card-title">Git config</h3>
<pre><code class="bash"># Show the current git config.
git config --list

# Add name.
git config --global user.name &lt;name&gt;

# Add email.
git config --global user.email &lt;email&gt;</code></pre>

    <h3 class="card-title"></h3>
<pre><code class="bash"># Show files that have added, modified, and deleted.
git status

# Move files to "staged".
git add -A

# Move files to "commited".
git commit -am &lt;message&gt;

# Apply your changes to a particular branch on remote repository.
git push origin &lt;branch&gt;</code></pre>

    <h3 class="card-title">Delete</h3>
<pre><code class="bash"># Delete a particular branch from your local.
git branch -d &lt;branch&gt;

# Delete a particular branch from remote repository.
git push origin -d &lt;branch&gt;

# Delete a tag from your local.
git tag -d &lt;tag&gt;

# Delete a tag from remote repository.
git push origin -d &lt;tag&gt;</code></pre>

    <h3 class="card-title">Git diff</h3>
<pre><code class="bash"># Compare two branches.
git diff &lt;branch_1&gt; &lt;branch_2&gt;

# Compare a specific file between two branches.
git diff &lt;branch_1&gt; &lt;branch_2&gt; -- &lt;file&gt;</code></pre>

    <h3 class="card-title">Moving uncommited changes to a new branch</h3>
    <ul>
      <li>Useful for example when accidently made changes to the master branch.</li>
    </ul>

<pre><code class="bash">git stash
git checkout -b &lt;branch_name&gt;
git stash apply</code></pre>

    <h3 class="card-title">Sync two repos</h3>

<pre><code class="bash"># First clone the original repo and cd into its root.
git remote add upstream &lt;clone_url&gt;  # "clone_url" should be url of sync repo.
git push upstream &lt;branch_name&gt;  # "branch_name" should a branch in sync_repo.</code></pre>
  </div>
  <div class="card-footer text-muted">

  </div>
</div>

<div class="card mb-4" id="git-4">
  <div class="card-body">
    <h2 class="card-title">Squashing commits</h2>
    <p class="card-text">When there are too many commits, it may be hard for other people to review your pull requests. Squashing commits comes handy.</p>
<pre><code class="bash"># Search your commit history and pick the one you want to squash commits from.
git log --oneline  # Or, git log --pretty=format:"%h%x09%an%x09%ad%x09%s"

# This opens nano editor.
# Use reword/pick/squash to specify what you want to do for each commit.
# Usually, "r" the first commit at the top and "s" the rest of commits. (For example, to avoid "Cannot 'squash' without a previous commit" error)
# Ctrl-O &amp; Ctrl-T will write your changes.
git rebase -p -i &lt;commit_hash&gt;

# Observe that commits have been squashed.
git log --oneline   # Or, git log --pretty=format:"%h%x09%an%x09%ad%x09%s"

# This opens nano editor. Enter new commit message. Ctrl-O &amp; Ctrl-T will write your changes.
git commit --amend

# Finally push the changes to your branch.
git push -f origin &lt;branch&gt;</code></pre>
  </div>
  <div class="card-footer text-muted">

  </div>
</div>

<div class="card mb-4" id="git-5">
  <div class="card-body">
    <h2 class="card-title">Branching</h2>
    <ul>
      <li><code>HEAD</code> (and branch) moves forward in each commit.</li>
      <li><code>detached HEAD</code> means that <code>HEAD</code> pointer is not pointing to a branch, but rather a commit id.</li>
    </ul>

    <h3 class="card-title"></h3>
<pre><code class="bash"># Pull code from a particular branch on remote repository into your local workspace.
git pull origin &lt;branch&gt;

# Create a new branch whose code base will be your local workspace.
git checkout -b &lt;branch&gt;

# Check out code base from a particular branch.
git checkout &lt;branch&gt;</code></pre>

    <h3 class="card-title">Branch management</h3>
<pre><code class="bash"># Update tracking of remote branches.
git fetch

# Remove local branches that do not exist in remote.
git fetch --prune

# Display local and remote branches.
git branch -a

# Remove all untracked files.
git clean -f</code></pre>
  </div>
  <div class="card-footer text-muted">

  </div>
</div>

<div class="card mb-4" id="git-6">
  <div class="card-body">
    <h2 class="card-title">Revert</h2>

    <h3 class="card-title">Revert changes in local branch</h3>

<pre><code class="bash"># Show lost commits.
git reflog

# Revert to a deleted commit. (Assuming &lt;commit_hash&gt; was retrieved from the output of "git reflog")
git reset --hard &lt;commit_hash&gt;

# Revert to previous commit in the remote.
git reset --hard &lt;commit_hash&gt;
git push -f origin &lt;branch&gt;

# Discard changes in a particualr file. / Restore a deleted file.
git checkout HEAD &lt;file&gt;

# Force overwrite local with remote.
git fetch --all
git reset --hard origin/&lt;branch_name&gt;

# &lt;commit_hash&gt; should come from &lt;source_branch&gt;. Last two steps are to clean up the &lt;source_branch&gt;
git checkout &lt;target_branch&gt;
git cherry-pick &lt;commit_hash&gt;
git checkout &lt;source_branch&gt;
git reset --hard HEAD~1 </code></pre>
<!-- probably should use "git branch | grep -v "master" | xargs git branch -D "-->

    <h3 class="card-title">Revert a merged PR</h3>

<pre><code class="bash"># Checkout a branch from master. Ex. git checkout -b revert

# This reverts a particular commit
git revert -m 1 &lt;commit_hash_of_PR_to_revert&gt;

# This reverts everything up to but not including commit_hash
git revert -m 1 &lt;commit_hash&gt;..HEAD

# Then push the reverted changes to the branch.
git push origin revert

# Finally, raise a PR from revert to master</code></pre>

    <h3 class="card-title">Revert a single file</h3>

<pre><code class="bash">git checkout &lt;commit_hash_of_file_to_revert_to&gt; -- &lt;file_including_path&gt;
git commit -am &lt;commit_message&gt;
git push origin &lt;branch_name&gt;</code></pre>
  </div>
  <div class="card-footer text-muted">

  </div>
</div>
<!-- Git END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>