<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/js/highlight.pack.js" type="text/javascript"></script>
<script src="/js/include_html.js" type="text/javascript"></script>
<script src="/js/mathjax/tex-chtml.js" type="text/javascript"></script>
<script src="/js/site.js" type="text/javascript"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Machine Learning</h1>

<!-- Distributed training BEGIN -->
<div class="card mb-4" id="distributed-training">
  <div class="card-body">
    <h2 class="card-title">Distributed training</h2>
    <ul class="list-unstyled mb-0">
      <li><a href="#distributed-training-">Requirement and problem</a></li>
      <li><a href="#distributed-training-">High-level design</a></li>
      <li><a href="#distributed-training-">Data and feature engineering</a></li>
      <li><a href="#distributed-training-">Model development</a></li>
      <li><a href="#distributed-training-">Inference and evaluation</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="distributed-training-">
  <div class="card-body">
    <h2 class="card-title">Requirement and problem</h2>
    <ul>
      <li>Business</li>
      <ul>
        <li>What is purpose of chatbot?</li>
        <li>Should chatbot have general knowledge or also domain specific knowledge? Domain specific - #1</li>
        <li>Should chatbot support text, image, video, math, etc? Text only - #2</li>
        <li>Should chatbot consider human-preferable answers? yes - #3 (if time)</li>
      </ul>
      <li>Data</li>
      <ul>
        <li>Do we have training data? We have corpus that we can crawl from web</li>
        <li>Do we also have domain specific data? Yes, 100M sets of questions and answers</li>
      </ul>
      <li>Contraint</li>
      <ul>
        <li>Should model be deployed to mobile devices? No</li>
        <li>How fast should inference be - under 200ms</li>
      </ul>
      <li>Problem - generate response per user query</li>
      <li>Input - user prompt</li>
      <li>Output - text response from model</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference:
  </div>
</div>

<div class="card mb-4" id="distributed-training-">
  <div class="card-body">
    <h2 class="card-title">High-level design</h2>
  </div>
  <div class="card-footer text-muted">
    Reference:
  </div>
</div>

<div class="card mb-4" id="distributed-training-">
  <div class="card-body">
    <h2 class="card-title">Data and feature engineering</h2>
    <ul>
      <li>Data</li>
      <ul>
        <li>Tokenization</li>
        <li>Token to IDs</li>
      <li>Feature</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference:
  </div>
</div>

<div class="card mb-4" id="distributed-training-">
  <div class="card-body">
    <h2 class="card-title">Model development</h2>
    <ul>
      <li>Pre-training</li>
      <ul>
        <li>Training with large corpus to learn general pattern</li>
        <li>Transformer based decoder model</li>
        <li>Loss - cross-entropy to predict likelihood of next token</li>
      </ul>
      <li>Fine-tuning</li>
      <ul>
        <li>With pre-trained model, fine-tune with domain specific data</li>
        <li>Transformer based decoder model</li>
        <li>Loss - cross-entropy to predict likelihood of next token</li>
      </ul>
      <li>Reinforcement learning from human feedback</li>
      <ul>
        <li>Training data - for same user input, rank model outputs</li>
        <li></li>
        <li></li>
      </ul>
      <li>RAG</li>
      <ul>
        <li>Ingest domain specific data into vector database</li>
        <li>Find cosine similarity between user query embedding and document embeddings in vector DB to retrieve top k results</li>
        <li>Use separate re-ranker to find most relevant document</li>
        <li>Call model with user query and document</li>
        <li>No model training but slower due to having to query vector DB and re-ranker</li>
      </ul>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference:
  </div>
</div>

<div class="card mb-4" id="distributed-training-">
  <div class="card-body">
    <h2 class="card-title">Model development</h2>
    <ul>
      <li>Pre-training</li>
      <ul>
        <li>Training with large corpus to learn general pattern</li>
        <li>Transformer based decoder model</li>
        <li>Loss - cross-entropy to predict likelihood of next token</li>
      </ul>
      <li>Fine-tuning</li>
      <ul>
        <li>With pre-trained model, fine-tune with domain specific data</li>
        <li>Transformer based decoder model</li>
        <li>Loss - cross-entropy to predict likelihood of next token</li>
      </ul>
      <li>Reinforcement learning from human feedback</li>
      <ul>
        <li>Training data - for same user input, rank model outputs</li>
        <li></li>
        <li></li>
      </ul>
      <li>RAG</li>
      <ul>
        <li>Ingest domain specific data into vector database</li>
        <li>Find cosine similarity between user query embedding and document embeddings in vector DB to retrieve top k results</li>
        <li>Use separate re-ranker to find most relevant document</li>
        <li>Call model with user query and document</li>
        <li>No model training but slower due to having to query vector DB and re-ranker</li>
      </ul>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference:
  </div>
</div>

<div class="card mb-4" id="distributed-training-">
  <div class="card-body">
    <h2 class="card-title">Inference and evaluation</h2>
    <ul>
      <li>Sampling</li>
      <ul>
        <li>Top k sampling - deterministic because it only considers k most probable words (Ex. beam search)</li>
        <li>Top p sampling - provides little randomness by including all words up to certain probability (p)</li>
      </ul>
      <li>Evaluation</li>
      <ul>
        <li>RAG</li>
        <ul>
          <li>Retriever - recall</li>
          <li>Reranker - precision</li>
          <li>Model - factual accuracy, number of harmful response</li>
        </ul>
      </ul>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference:
  </div>
</div>
<!-- Distributed training END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>