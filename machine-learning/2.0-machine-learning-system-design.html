<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/js/highlight.pack.js" type="text/javascript"></script>
<script src="/js/include_html.js" type="text/javascript"></script>
<script src="/js/mathjax/tex-chtml.js" type="text/javascript"></script>
<script src="/js/site.js" type="text/javascript"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Machine learning</h1>

<!-- Machine learning system design BEGIN -->
<div class="card mb-4" id="machine-learning-system-design">
  <div class="card-body">
    <h2 class="card-title">Machine learning system design</h2>
    <ul class="list-unstyled mb-0">
      <li><a href="#machine-learning-system-design-">Machine learning system design</a></li>
      <li><a href="#machine-learning-system-design-">Requirement</a></li>
      <li><a href="#machine-learning-system-design-">Problem</a></li>
      <li><a href="#machine-learning-system-design-">Data preparation</a></li>
      <li><a href="#machine-learning-system-design-">Model development</a></li>
      <li><a href="#machine-learning-system-design-">Evaluation</a></li>
      <li><a href="#machine-learning-system-design-">Serving</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Machine learning system design</h2>
    <ul>
      <li>Talking points</li>
      <ul>
        <li>Discuss business requiremnent</li>
        <li>Discuss machine learning problem</li>
        <li>Discuss business metrics</li>
        <li>Discuss online metrics</li>
        <li>Discuss architectural component</li>
        <li>Discuss training data</li>
        <li>Discuss offline metrics</li>
        <li>Discuss features</li>
        <li>Discuss model</li>
      </ul>
    </ul>

    <h3 class="card-title">Design problems</h3>
    <ul>
      <li>Reference</li>
      <ul>
        <li><a href="/machine-learning/2.0-machine-learning-design-patterns.html">Machine learning design patterns</a></li>
        <li><a href="/machine-learning/2.0-designing-machine-learning-systems.html">Designing machine learning systems</a></li>
      </ul>
      <li>Practice</li>
      <ul>
        <li><a href="/machine-learning/2.3-instagram.html">Design instragram</a></li>
        <li><a href="/machine-learning/2.3-chatbot.html">Design chatbot</a></li>
        <li><a href="/machine-learning/2.3-banking.html">Design banking</a></li>
      </ul>
      <li>Example</li>
      <ul>
        <li><a href="/machine-learning/2.1-visual-search-system.html">Design visual search system</a></li>
        <li><a href="/machine-learning/2.1-google-street-view-blurring-system.html">Design google street view blurring system</a></li>
        <li><a href="/machine-learning/2.1-youtube-video-search.html">Design youtube video search</a></li>
        <li><a href="/machine-learning/2.1-harmful-content-detection.html">Design harmful content detection</a></li>
        <li><a href="/machine-learning/2.1-video-recommendation-system.html">Design video recommendation system</a></li>
        <li><a href="/machine-learning/2.1-event-recommendation-system.html">Design event recommendation system</a></li>
        <li><a href="/machine-learning/2.1-ad-click-prediction-on-social-platform.html">Design ad click prediction on social platform</a></li>
        <li><a href="/machine-learning/2.1-similar-listings-on-vacation-rental-platforms.html">Design similar listings</a></li>
        <li><a href="/machine-learning/2.1-personalized-news-feed.html">Design personalized newsfeed</a></li>
        <li><a href="/machine-learning/2.1-people-you-may-know.html">Design people you may know</a></li>
        <li><a href="/machine-learning/2.2-gmail-smart-compose.html">Design google smart compose</a></li>
        <li><a href="/machine-learning/2.2-google-translate.html">Design google translate</a></li>
        <li><a href="/machine-learning/2.2-chatgpt.html">Design ChatGPT</a></li>
        <li><a href="/machine-learning/2.2-image-captioning.html">Design image captioning</a></li>
        <li><a href="/machine-learning/2.2-rag.html">Design RAG</a></li>
        <li><a href="/machine-learning/2.2-realistic-face-generation.html">Design realistic face generation</a></li>
        <li><a href="/machine-learning/2.2-high-resolution-image-synthesis.html">Design high-resolution image synthesis</a></li>
        <li><a href="/machine-learning/2.2-text-to-image-generation.html">Design text-to-image generation</a></li>
        <li><a href="/machine-learning/2.2-personalized-headshot-generation.html">Design personalized headshot generation</a></li>
        <li><a href="/machine-learning/2.2-text-to-video-generation.html">Design text-to-video generation</a></li>
      </ul>
    </ul>
    <h3 class="card-title">Other problems</h3>
    <ul>
      <li>Explain difference between batch serving and online serving</li>
      <li>Explain strategies for re-training the model</li>
      <li>Explain how to use model registry and model versioning</li>
      <li>Explain how to monitor the model</li>
      <li>Explain how to orchestrate workflow using Airflow/Kubeflow"</li>
      <li>Explain how to track experiments using MLflow</li>
      <li>Explain how to achieve scaling, load-balancing, fast response for LLM application</li>
      <li>Explain how to use caching to improve LLM performance</li>
      <li>Explain how to reduce model size and optimize for deployment on smart phones</li>
      <li>Explain trade-off between GPU and TPU</li>
      <li>Explain how to monitor LLM in production</li>
      <li>Explain how vector database work</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: 
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Requirement</h2>
    <ul>
      <li>Business objective</li>
      <ul>
        <li>What is purpose of the system?</li>
        <li>Should the model output be personalized to each user?</li>
        <li>Should the model output handle bias and fairness concern?</li>
        <li>Should the system support multiple languages?</li>
      </ul>
      <li>System features</li>
      <ul>
        <li>What kind of user actions are available?</li>
      </ul>
      <li>Data</li>
      <ul>
        <li>Does the system have training data available? What is the size of dataset?</li>
        <li>Should the system collect data from user interactions?</li>
      </ul>
      <li>Constraints</li>
      <ul>
        <li>How much computing power does the system have?</li>
        <li>Should the model be deployed to mobile devices?</li>
        <li>Should the model be continuouly trained?</li>
      </ul>
      <li>Scale</li>
      <ul>
        <li>How many total users are there? How many daily active users are there?</li>
        <li>How many inferences does each user make daily?</li>
        <li>How many items are there?</li>
        <li>What is the rate of growth?</li>
      </ul>
      <li>Performance</li>
      <ul>
        <li>What should be the latency of prediction?</li>
        <li>Can the inference be batch or should it be in real-time?</li>
      </ul>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Problem</h2>

    <h3 class="card-title">ML problem</h3>
    <ul>
      <li>Input and output of model</li>
    </ul>

    <h3 class="card-title">ML category</h3>
    <ul>
      <li>Discrimitive</li>
      <ul>
        <li>Supervised learning</li>
        <ul>
          <li>Neural networks</li>
          <ul>
            <li>Linear network</li>
            <ul>
              <li>Linear regression (regression only)</li>
              <li>Logistic regression (classification only - binary, multi-class, multi-label)</li>
            </ul>
            <li>Deep neural networks</li>
            <li>Convolutional neural networks</li>
            <li>Recurrent neural networks</li>
          </ul>
          <li>Decision trees</li>
          <li>k-nearest neighbors (KNN)</li>
        </ul>
        <li>Unsupervised learning</li>
        <ul>
          <li>Clustering</li>
          <ul>
            <li>Density-based spacial clustering with noise (DBSCAN)</li>
            <li>K-means clustering - partition points into K subsets, compute centroid of current partitioning, assign each point to cluster</li>
          </ul>
          <li>Dimension reduction</li>
          <ul>
            <li>Principle component analysis (PCA)</li>
            <li>Isomap</li>
          </ul>
        </ul>
      </ul>
      <li>Generative</li>
      <ul>
        <li>Text</li>
        <ul>
          <li>Pre-training</li>
          <ul>
            <li>Encoder-decoder</li>
            <li>Encoder only</li>
            <li>Decoder only</li>
          </ul>
          <li>Fine-tuning</li>
          <li>Retrieval augmented generation</li>
        </ul>
        <li>Image</li>
        <ul>
          <li>Variational autoencoders (VAEs)</li>
          <li>Generative adversarial networks (GANs)</li>
          <li>Diffusion models</li>
          <li>Autoregressive models</li>
        </ul>
      </ul>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Data preparation</h2>

    <h3 class="card-title">Data engineering</h3>
    <ul>
      <li>Identify data sources and their storage type</li>
      <ul>
        <li>SQL</li>
        <ul>
          <li>Relational</li>
          <ul>
            <li>Ex. MySQL, PostgreSQL</li>
          </ul>
        </ul>
        <li>NoSQL</li>
        <ul>
          <li>Key-value</li>
          <ul>
            <li>Ex. Redis, DynamoDB</li>
          </ul>
          <li>Column-based</li>
          <ul>
            <li>Ex. Cassandra, HBase</li>
          </ul>
          <li>Graph</li>
          <ul>
            <li>Ex. Neo4J</li>
          </ul>
          <li>Document</li>
          <ul>
            <li>Encoded as JSON, XML</li>
            <li>Each document has a unique key</li>
            <li>Does not enforce any schema</li>
            <li>Hard to join documents</li>
            <li>Ex. MongoDB, CouchDB</li>
          </ul>
        </ul>
      </ul>
      <li>ETL</li>
      <ul>
        <li>Extract - extract data from different data sources</li>
        <li>Transform - clean and transform data into specific format</li>
        <li>Load - load transformed data into target data warehouse</li>
      </ul>
      <!-- <li>Training data</li>
      <ul>
        <li>Collect raw data</li>
        <li>Identify features and labels</li>
        <li>Sampling</li>
        <li>Split data</li>
        <ul>
          <li>Split must be repeatable</li>
          <ul>
            <li>Use fixed seed number</li>
            <li>If distributed training environment, store the splitted data</li>
          </ul>
        </ul>
        <li>Address class imbalance</li>
      </ul> -->
      <!-- <li>Database</li>
      <ul>
        
        </ul> -->
        <!-- <li>In which format should data be stored?</li> -->
        <!-- <li>How to store multimodal data? (Data containing both image and text)</li> -->
      </ul>
    </ul>

    <h3 class="card-title">Exclusion</h3>

    <h3 class="card-title">Base population (Sampling)</h3>

    <h3 class="card-title">Target generation</h3>

    <h3 class="card-title">Feature selection</h3>

    <h3 class="card-title">Feature engineering</h3>
    <ul>
      <li>Handle missing values</li>
      <li>Scaling</li>
      <li>Bucketing</li>
      <li>Encode categorial features</li>
    </ul>
    <!-- <ul>
      <li>Too many features</li>
      <ul>
        <li>Increased risk of data leakage</li>
        <li>Can cause overfitting</li>
        <li>Increases memory requirement</li>
        <li>Increases inference latency, especially if prediction requires extracting features</li>
        <li>Useless features become techinical debt</li>
        <ul>
          <li>When data pipeline changes, all affected features need to adjust</li>
          <li>In theory, regularization should reduce weight of useless features to 0. However, model learns faster without useless features</li>
        </ul>
      </ul>
      <li>Feature selection</li>
      <ul>
        <li>Filter method</li>
        <ul>
          <li>Assign score to each feature</li>
          <li>Often considers features independent</li>
          <li>Ex. chi squared test, information gain, correlation coefficient scores</li>
        </ul>
        <li>Embedded method</li>
        <ul>
          <li>Learn which features are contributing to the accuracy of model</li>
          <li>Ex. regularization (LASSO, elastic net, ridge regression)</li>
        </ul>
      </ul>
    </ul> -->
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Model development</h2>

    <h3 class="card-title">Model selection</h3>
    <ul>
      <li>Linear or logistic regression</li>
      <ul>
        <li>Pros</li>
        <ul>
          <li></li>
        </ul>
        <li>Cons</li>
        <ul>
          <li></li>
        </ul>
      </ul>
      <li>XGBoost</li>
      <ul>
        <li>Pros</li>
        <ul>
          <li></li>
        </ul>
        <li>Cons</li>
        <ul>
          <li></li>
        </ul>
      </ul>
      <li>Neural network</li>
      <ul>
        <li>Pros</li>
        <ul>
          <li></li>
        </ul>
        <li>Cons</li>
        <ul>
          <li></li>
        </ul>
      </ul>
    </ul>

    <h3 class="card-title">Model training</h3>
    <ul>
      <li>Data split</li>
      <li>Class imbalance</li>
      <li>Loss function</li>
      <ul>
        <li>Regression</li>
        <ul>
          <li>MSE</li>
          <li>MAE</li>
        </ul>
        <li>Multiclass classification</li>
        <ul>
          <li>Cross-entropy</li>
        </ul>
        <li>Binary classification</li>
        <ul>
          <li>Log loss</li>
        </ul>
        <li>?</li>
        <ul>
          <li>Huber loss</li>
        </ul>
      </ul>
      <li>Hyperparameters</li>
      <li>Sampling</li>
      <!-- <li>Regularization</li>
      <ul>
        <li>L1</li>
        <li>L2</li>
        <li>Entropy regularization</li>
        <li>K-fold CV</li>
        <li>Dropout</li>
      </ul>
      <li>Optimization</li>
      <ul>
        <li>SGD</li>
        <li>AdaGrad</li>
        <li>Momentum</li>
        <li>RMSProp</li>
      </ul>
      <li>Activation</li>
      <ul>
        <li>ELU</li>
        <li>ReLU</li>
        <li>Tanh</li>
        <li>Sigmoid</li>
      </ul>
      <li>Save the transformation applied to convert model inputs into features</li>
      <li>How to overcome underfitting and overfitting (bias and variance)</li> -->
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Evaluation</h2>

    <h3 class="card-title">Offline</h3>
    <ul>
      <li>Classification</li>
      <ul>
        <li>Precision</li>
        <li>Recall</li>
        <li>F1 score</li>
        <li>Accuracy</li>
        <li>ROC-AUC</li>
        <li>PR-AUC</li>
        <li>Confusion matrix</li>
      </ul>
      <li>Regression</li>
      <ul>
        <li>MSE</li>
        <li>MAE</li>
        <li>RMSE</li>
      </ul>
      <li>Ranking</li>
      <ul>
        <li>Precision@k</li>
        <li>Recall@k</li>
        <li>MRR</li>
        <li>mAP</li>
        <li>nDCG</li>
      </ul>
      <li>Text generation</li>
      <ul>
        <li>BLUE</li>
        <li>METEOR</li>
        <li>ROUGE</li>
        <li>CIDEr</li>
        <li>SPICE</li>
      </ul>
      <li>Image generation</li>
      <ul>
        <li>FID</li>
        <li>Inception score</li>
      </ul>
    </ul>
      <!-- <li>Baselines</li>
      <ul>
        <li>Random baseline</li>
        <li>Simple heuristic</li>
        <li>Zero rule baseline</li>
        <li>Human baseline</li>
        <li>Existing solutions</li>
      </ul>
      <li>Methods</li>
      <ul>
        <li>Purturbation tests</li>
        <li>Invariance tests</li>
        <li>Directional expectation tests</li>
        <li>Model calibration</li>
        <li>Confidence measurement</li>
        <li>Slice-based evaluation</li>
      </ul> -->
    
    <h3 class="card-title">Online</h3>
    <ul>
      <li>Increase in revenue</li>
      <li>Increase in number of users</li>
      <li>Improvement in user engagement metrics</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu
  </div>
</div>

<div class="card mb-4" id="machine-learning-system-design-">
  <div class="card-body">
    <h2 class="card-title">Serving</h2>

    <h3 class="card-title">Data pipeline</h3>

    <img class="img-fluid" class="card-img-top" src="/machine-learning/image/machine-learning-system-design-1.png" alt="Card image cap">

    <h3 class="card-title">Training pipeline</h3>

    <img class="img-fluid" class="card-img-top" src="/machine-learning/image/machine-learning-system-design-2.png" alt="Card image cap">

    <h3 class="card-title">Serving pipeline</h3>

    <img class="img-fluid" class="card-img-top" src="/machine-learning/image/machine-learning-system-design-3.png" alt="Card image cap">

    <!-- <ul>
      <li>ML failure</li>
      <ul>
        <li>Edge cases</li>
        <li>Degenerate feedback loops</li>
        <ul>
          <li>Detecting</li>
          <li>Correcting</li>
        </ul>
      </ul>
    </ul> -->

    <li>Model compression</li>
    <ul>
      <li>Knowledge distillation - train small model to mimic larger model</li>
      <li>Pruning - find least useful parameters and set them to zero</li>
      <li>Quantization - use fewer bits to represent parameters</li>
    </ul>

    <li>Cloud vs on-device</li>
    <ul>
      <li>Cloud - simple to deploy, faster inference, fewer constraints</li>
      <li>On-device - no cloud cost, no network latency, more privacy, no internet required</li>
      <li>Two-phase prediction</li>
      <ul>
        <li>A problem is split into two parts</li>
        <li>Smaller and cheaper model deployed on device that can achieve high accuracy</li>
        <li>More complex model on cloud that is triggered only when it is needed</li>
      </ul>
    </ul>

    <li>Shadow deployment</li>
    <ul>
      <li>Deploy new model in parallel with existing model</li>
      <li>Inference from existing model is served to users</li>
      <li>Double number of prediction is needed</li>
    </ul>
    <li>A/B testing</li>
    <ul>
      <li>Deploy new model in parallel with existing model</li>
      <li>Portion of traffic is routed to new model</li>
    </ul>
  </div>
  <div class="card-footer text-muted">
    Reference: Machine Learning System Design Interview, Ali Aminian & Alex Xu
  </div>
</div>
<!-- Machine learning system design END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>