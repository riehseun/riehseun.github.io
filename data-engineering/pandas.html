<!DOCTYPE html>

<html lang="en">

<head>

<!-- Metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Seungmoon Rieh">
<meta name="keywords" content="">

<!-- Title and image -->
<title>Seungmoon Rieh</title>
<link href="/img/seungmoonrieh.jpg" rel="icon">

<!-- CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/monokai-sublime.css" rel="stylesheet">
<link href="/css/site.css" rel="stylesheet">

<!-- JavaScript -->
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>
<script src="/js/highlight.pack.js"></script>
<script type="text/javascript" src="/js/include_html.js"></script>
<script type="text/javascript" src="/js/site.js"></script>

</head>

<body>

<include src="/header.html"></include>

<div class="container">
<div class="row">
<div class="col-md-12">
<h1 class="my-4">Data Engineering</h1>

<!-- Pandas BEGIN -->
<div class="card mb-4" id="pandas">
  <div class="card-body">
    <h2 class="card-title">Pandas</h2>
    <p class="card-text"></p>
    <ul class="list-unstyled mb-0">
      <li><a href="#pandas-1">Pandas</a></li>
    </ul>
  </div>
</div>

<div class="card mb-4" id="pandas-1">
  <div class="card-body">
    <h2 class="card-title">Pandas</h2>

<pre><code class="python">import pandas as pd</code></pre>

    <h3 class="card-title">Series</h3>
    <ul>
      <li>Use <code>pd.Series</code> for 1-D data.</li>
    </ul>

<pre><code class="python">series = pd.Series(5)
# 0    5
# dtype: int64

series = pd.Series([1, 2, 3])
# 0    1
# 1    2
# 2    3
# dtype: int64

series = pd.Series([1, 2, 3], index=['a', 'b', 'c'])
# a    1
# b    2
# c    3
# dtype: int64

series = pd.Series({'a':1, 'b':2, 'c':3})
# a    1
# b    2
# c    3
# dtype: int64</code></pre>

    <h3 class="card-title">DataFrame</h3>
    <ul>
      <li>Use <code>pd.DataFrame</code> for 2-D data.</li>
    </ul>

<pre><code class="python">df = pd.DataFrame([[5, 6], [1, 3]],
                  index=['r1', 'r2'],
                  columns=['c1', 'c2'])
#     c1  c2
# r1   5   6
# r2   1   3

df = pd.DataFrame({'c1': [1, 2], 'c2': [3, 4]},
                  index=['r1', 'r2'])
#     c1  c2
# r1   1   3
# r2   2   4</code></pre>

<pre><code class="python">df = pd.DataFrame([[5, 6], [1.2, 3]])
ser = pd.Series([0, 0], name='r3')

df_app = df.append(ser)
#       0  1
# 0   5.0  6
# 1   1.2  3
# r3  0.0  0

df_app = df.append(ser, ignore_index=True)
#      0  1
# 0  5.0  6
# 1  1.2  3
# 2  0.0  0</code></pre>

<pre><code class="python">df = pd.DataFrame({'c1': [1, 2], 'c2': [3, 4],
                   'c3': [5, 6]},
                  index=['r1', 'r2'])

# Drop row r1
df_drop = df.drop(labels='r1')
#     c1  c2  c3
# r2   2   4   6

# Drop columns c1, c3
df_drop = df.drop(labels=['c1', 'c3'], axis=1)
#     c2
# r1   3
# r2   4</code></pre>

    <h3 class="card-title">Combining</h3>

<pre><code class="python">df1 = pd.DataFrame({'c1':[1,2], 'c2':[3,4]},
                   index=['r1','r2'])
df2 = pd.DataFrame({'c1':[5,6], 'c2':[7,8]},
                   index=['r1','r2'])
df3 = pd.DataFrame({'c1':[5,6], 'c2':[7,8]})

concat = pd.concat([df1, df2], axis=1)
#     c1  c2  c1  c2
# r1   1   3   5   7
# r2   2   4   6   8

concat = pd.concat([df2, df1, df3])
#     c1  c2
# r1   5   7
# r2   6   8
# r1   1   3
# r2   2   4
# 0    5   7
# 1    6   8

concat = pd.concat([df1, df3], axis=1)
#      c1   c2   c1   c2
# r1  1.0  3.0  NaN  NaN
# r2  2.0  4.0  NaN  NaN
# 0   NaN  NaN  5.0  7.0
# 1   NaN  NaN  6.0  8.0</code></pre>

    <h3 class="card-title">Merging</h3>

<pre><code class="python">mlb_df1 = pd.DataFrame({'name': ['john doe', 'al smith', 'sam black', 'john doe'],
                        'pos': ['1B', 'C', 'P', '2B'],
                        'year': [2000, 2004, 2008, 2003]})
#         name pos  year
# 0   john doe  1B  2000
# 1   al smith   C  2004
# 2  sam black   P  2008
# 3   john doe  2B  2003

mlb_df2 = pd.DataFrame({'name': ['john doe', 'al smith', 'jack lee'],
                        'year': [2000, 2004, 2012],
                        'rbi': [80, 100, 12]})
#         name pos  year
# 0   john doe  1B  2000
# 1   al smith   C  2004
# 2  sam black   P  2008
# 3   john doe  2B  2003

mlb_merged = pd.merge(mlb_df1, mlb_df2)
#        name pos  year  rbi
# 0  john doe  1B  2000   80
# 1  al smith   C  2004  100</code></pre>

    <h3 class="card-title">Indexing</h3>

<pre><code class="python">df = pd.DataFrame({'c1': [1, 2], 'c2': [3, 4],
                   'c3': [5, 6]}, index=['r1', 'r2'])

col1 = df['c1']
# r1    1
# r2    2
# Name: c1, dtype: int64</code></pre>

<pre><code class="python">df = pd.DataFrame({'c1': [1, 2, 3], 'c2': [4, 5, 6],
                   'c3': [7, 8, 9]}, index=['r1', 'r2', 'r3'])

# First two rows.
df[0:2]
#     c1  c2  c3
# r1   1   4   7
# r2   2   5   8
# r3   3   6   9

# Last two rows.
df['r2':'r3']
#     c1  c2  c3
# r1   1   4   7
# r2   2   5   8

df.iloc[1]
# c1    2
# c2    5
# c3    8
# Name: r2, dtype: int64

df.iloc[[0, 2]]
#     c1  c2  c3
# r1   1   4   7
# r3   3   6   9

df.loc['r2']
# c1    2
# c2    5
# c3    8
# Name: r2, dtype: int64</code></pre>

    <h3 class="card-title">CSV</h3>

<pre><code class="python">df = pd.read_csv('data.csv')
#         name pos  HR
# 0  joe smith  2B  17
# 1  alan west   C  28
# 2   john doe   P  19

df = pd.read_csv('data.csv', index_col=0)
#           pos  HR
# name
# joe smith  2B  17
# alan west   C  28
# john doe    P  19

df = pd.read_csv('data.csv', index_col=1)
#           name  HR
# pos
# 2B   joe smith  17
# C    alan west  28
# P     john doe  19

# Write to csv.
df.to_csv('data.csv')</code></pre>

    <h3 class="card-title">JSON</h3>

<pre><code class="python">data
# {'tom june': {'pos': 'P', 'HR': 31}, 'jack doe': {'pos': '1B', 'HR': 4}}

df = pd.read_json('data.json')
#     tom june jack doe
# pos        P       1B
# HR        31        4

df = pd.read_json('data.json', orient='index')
#          pos  HR
# tom june   P  31
# jack doe  1B   4

# Write to json.
df.to_json('data.json')</code></pre>

    <h3 class="card-title">Grouping</h3>

<pre><code class="python">df
#    yearID teamID     H    R
# 0    2017    CLE  1449  818
# 1    2015    CLE  1395  669
# 2    2016    BOS  1598  878
# 3    2015    DET  1515  689
# 4    2016    DET  1476  750
# 5    2016    CLE  1435  777
# 6    2015    BOS  1495  748
# 7    2017    BOS  1461  785
# 8    2017    DET  1435  735

groups = df.groupby('yearID')
groups.get_group(2016))
#    yearID teamID     H    R
# 2    2016    BOS  1598  878
# 4    2016    DET  1476  750
# 5    2016    CLE  1435  777

groups.sum()
#            H     R
# yearID
# 2015    4405  2106
# 2016    4509  2405
# 2017    4345  2338

groups.mean()
#                  H           R
# yearID
# 2015    1468.333333  702.000000
# 2016    1503.000000  801.666667
# 2017    1448.333333  779.333333

groups.filter(lambda x: x.name > 2015)
#    yearID teamID     H    R
# 0    2017    CLE  1449  818
# 2    2016    BOS  1598  878
# 4    2016    DET  1476  750
# 5    2016    CLE  1435  777
# 7    2017    BOS  1461  785
# 8    2017    DET  1435  735</code></pre>

<pre><code class="python">groups = player_df.groupby(['yearID', 'teamID'])

groups.sum()
#                  H
# yearID teamID
# 2016   BOS     607
#        HOU     374
# 2017   BOS     441
#        HOU     337</code></pre>

  </div>
  <div class="card-footer text-muted">
    Reference: <a href="https://www.educative.io/path/become-a-machine-learning-engineer">Become a Machine Learning Engineer</a>
  </div>
</div>
<!-- Pandas END -->

</div> <!-- /.col-md-12 -->
</div> <!-- /.row -->
</div> <!-- /.container -->

<include src="/footer.html"></include>

</body>

</html>